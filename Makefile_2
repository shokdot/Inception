COMPOSE_FILE	= srcs/docker-compose.yml

DOCKER			= docker
COMPOSE			= docker-compose -f $(COMPOSE_FILE)
MKDIR			= mkdir -p
RM				= rm -rf

DATA_DIR		= $(HOME)/data
DB_DIR			= $(DATA_DIR)/mariadb
WP_DIR			= $(DATA_DIR)/wordpress

all: build

$(DB_DIR) $(WP_DIR):
	@$(MKDIR) $@

build: | $(DB_DIR) $(WP_DIR)
	@$(COMPOSE) build

up:
	@echo "Making Up."
	@$(COMPOSE) up -d --build

down:
	@echo "Making Down."
	@$(COMPOSE) down

re: down up

clean: down

fclean: clean
	@$(COMPOSE) down --volumes --rmi all --remove-orphans 2>/dev/null || true
	@$(RM) $(DATA_DIR)

ps:
	@$(COMPOSE) ps

.PHONY: all build up down re clean fclean ps
